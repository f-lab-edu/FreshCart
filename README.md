# ğŸ  ì„œë¹„ìŠ¤ ì†Œê°œ

ë§ˆì¼“ì»¬ë¦¬ì™€ ê°™ì´ ì‹ ì„  ì‹í’ˆì„ íŒë§¤í•˜ëŠ” ì˜¨ë¼ì¸ ì‹ì¬ë£Œ íŒë§¤ ì„œë¹„ìŠ¤  

# ğŸ”—  ì‚¬ìš© ê¸°ìˆ  ìŠ¤íƒ
- Java 11, Spring Boot, Gradle 
- JPA, MyBatis
- MySQL, Flyway
- Redis Clustering
- Docker
- ElasticSearch
- Github Actions 

# ğŸ”— ì„œë¹„ìŠ¤ êµ¬ì¡° 

![img.png](img/architecture.png)

# ğŸ“Œ í”„ë¡œì íŠ¸ ì˜ë„ 

### ê°ì²´ ì§€í–¥ ì„¤ê³„
- ë ˆì´ì–´ë“œ ì•„í‚¤í…ì²˜ë¥¼ ë„ì…í•˜ì—¬, ê´€ì‹¬ì‚¬ë¥¼ ë¶„ë¦¬í•˜ê³  ë‹¨ë°©í–¥ìœ¼ë¡œ ì˜ì¡´ì„±ì„ ì œí•œí–ˆìŠµë‹ˆë‹¤.  
- ë³€ê²½ ê°€ëŠ¥ì„±ì´ ìˆëŠ” í´ë˜ìŠ¤ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ë³€ê²½ì— ìœ ì—°í•˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤.

### ë¬¸ì œ ìƒí™©ì— ëŒ€í•œ ëŒ€ì²˜ 
- ì¬ê³ ì— ìœ ì €ê°€ ë™ì‹œì— ì ‘ê·¼í•´, ê²½ìŸìƒíƒœê°€ ë°œìƒí•  ê²½ìš° -> ë¹„ê´€ì  ë½ ì ìš©
- ì„œë²„ í™•ì¥(scale-out)ì— ëŒ€ë¹„ -> ì„¸ì…˜ ë¡œê·¸ì¸ì— Redis ì ìš©í•˜ì—¬ ì €ì¥ì†Œ ì¤‘ì•™í™” 
- Redis Fail ì— ëŒ€í•œ ëŒ€ë¹„ -> Redis Clustering ì ìš© 

### ê¸°ìˆ ì— ëŒ€í•œ ê¹Šì´ ìˆëŠ” í•™ìŠµ
- ì—¬ëŸ¬ ê¸°ìˆ ì˜ ì¥ë‹¨ì ì„ ë¹„êµí•˜ê³  ì‚¬ìš©í•´ë³¸ ë’¤, ìƒí™©ì— ë§ëŠ” ê¸°ìˆ ì„ ì“°ê³ ì í–ˆìŠµë‹ˆë‹¤.
- í•™ìŠµ ëª©ì ì˜ í”„ë¡œì íŠ¸ì´ê¸° ë•Œë¬¸ì—, ê¸°ìˆ ì˜ ê°œë°œ ì˜ë„ë¥¼ ì´í•´í•˜ê³  ê¹Šì´ ìˆê²Œ ì¨ë³´ê³  ì‹¶ì—ˆìŠµë‹ˆë‹¤. 
  ì´ë¥¼ ìœ„í•´ ì¸ì¦ ê¸°ëŠ¥ì— ì‚¬ìš©ë˜ëŠ” HttpSession, ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ë“±ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì§ì ‘ êµ¬í˜„ í–ˆìŠµë‹ˆë‹¤.

### ì½”ë“œ ê°œì„  
- ì¸ì¦/ì¸ê°€ ì‹œ AOPë¥¼ í™œìš©í•˜ì—¬, ë°˜ë³µì ì¸ ì½”ë“œë¥¼ ì¤„ì˜€ìŠµë‹ˆë‹¤.
- Google CheckStyleë¡œ ì½”ë”© ì»¨ë²¤ì…˜ì„ ì ìš©í•˜ê³  ì¤€ìˆ˜í•˜ì˜€ìŠµë‹ˆë‹¤. 

# ğŸ“Œ  íŠ¸ëŸ¬ë¸” ìŠˆíŒ… / ê¸°ìˆ  ì„ íƒ ê³¼ì • 

ì œëª©ì„ í´ë¦­í•˜ì‹œë©´ ë¸”ë¡œê·¸ í¬ìŠ¤íŒ…ì—ì„œ ìì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

- [[JPA/MYSQL] ì¬ê³ ì— ë™ì‹œ ì ‘ê·¼í•  ë•Œ ì¼ì–´ë‚˜ëŠ” ê°±ì‹  ë¶„ì‹¤ ë¬¸ì œ í•´ê²°í•˜ê¸°](https://writerroom.tistory.com/338)


- [ê°ì²´ ì§€í–¥ì  ì„¤ê³„/ìœ ì§€ ë³´ìˆ˜í•˜ê¸° ì¢‹ì€ ì½”ë“œë¥¼ ìœ„í•œ ê³ ë¯¼](https://writerroom.tistory.com/332)


- [Redisë¡œ ë‹¤ì¤‘ ì„œë²„ í™˜ê²½ì—ì„œ ë¡œê·¸ì¸ ì •ë³´ ë¶ˆì¼ì¹˜ ë¬¸ì œ í•´ê²°](https://writerroom.tistory.com/333)


- [Redis Clustering ë¥¼ í†µí•´ FailOver êµ¬í˜„í•˜ê¸° (ë„ì»¤ ì»´í¬ì¦ˆ í™˜ê²½)](https://writerroom.tistory.com/341)


- [ë¡œê·¸ì¸ êµ¬í˜„ ì‹œ ì„¸ì…˜ê³¼ í† í° ë°©ì‹ ë¹„êµ](https://writerroom.tistory.com/320)


- [ì¸í„°ì…‰í„° / ì»¤ìŠ¤í…€ ì• ë…¸í…Œì´ì…˜ í™œìš©í•˜ì—¬ ë¡œê·¸ì¸ ê°•ì œ](https://writerroom.tistory.com/326)


- [í˜‘ì—…ì— ìš©ì´í•œ ì‘ì—… í™˜ê²½ êµ¬ì„±](https://writerroom.tistory.com/336)


- [ì†”íŠ¸ë¥¼ ì´ìš©í•´ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™”ì˜ ë³´ì•ˆ ê°•í™”](https://writerroom.tistory.com/327)

# ğŸ“Œ  ERD ì„¤ê³„
[ERD ì„¤ê³„](https://www.erdcloud.com/d/ezfSvS66CSxhzFp8o)

![img.png](img/img.png)


#  ğŸ”— ê¸°ëŠ¥ ëª…ì„¸ì„œ

## Common 

- ìœ ì €ê°€ ê³ ìœ í•œ ì´ë©”ì¼ ì£¼ì†Œë¡œ `íšŒì›ê°€ì…`ì„ í•©ë‹ˆë‹¤.  
- ìœ ì €ëŠ” `íšŒì›ê°€ì…`ì„ í†µí•´ Roleì„ íšë“í•©ë‹ˆë‹¤.
- ìœ ì €ê°€ `ë¡œê·¸ì¸`ì„ í†µí•´ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•©ë‹ˆë‹¤ (ì£¼ë¬¸ ë“±)
- ìœ ì €ëŠ” ì„œë¹„ìŠ¤ë¥¼ ë‚˜ê°€ê¸° ìœ„í•´ `ë¡œê·¸ì•„ì›ƒ`ì„ í•´ì•¼ í•©ë‹ˆë‹¤.

## Seller
- íŒë§¤ìëŠ” `ìƒí’ˆì„ ë“±ë¡`í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
- íŒë§¤ìëŠ” ë“±ë¡í•œ ìƒí’ˆì˜ `ì¬ê³ ë¥¼ ë“±ë¡`í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
  (ë‹¨ì¼ ìƒí’ˆì€ ìƒí’ˆ ë³„ë¡œ, ë¶€ê°€ ì˜µì…˜ì´ ìˆëŠ” ì œí’ˆì€ ì˜µì…˜ ë³„ë¡œ ë“±ë¡í•©ë‹ˆë‹¤.)
- íŒë§¤ìëŠ” ì•„ëª¬ë“œ ìš°ìœ  2ì¢…ê³¼ ê°™ì´ ë‹¨ì¼ ìƒí’ˆì´ ì•„ë‹Œ ê²½ìš°, ì•„ë˜ì™€ ê°™ì´ `ì˜µì…˜ì„ ì§€ì •`í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

(1) í•„ìˆ˜ / ì„ íƒ ì—¬ë¶€

(2) ì˜µì…˜ ë³„ë¡œ ê°€ê²©ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ.

(3) íŠ¹ì • ì˜µì…˜ì€ ì£¼ë¬¸ ê°€ëŠ¥ ê°œìˆ˜ ì œí•œì„ ê°€ì§ˆ ìˆ˜ ìˆìŒ.

(4) ì˜µì…˜ì€ í•œ ê°œë§Œ/ì—¬ëŸ¬ ê°œ ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡ ì§€ì •í•  ìˆ˜ ìˆìŒ.

## Buyer
- ìœ ì €ëŠ” í™”ë©´ì—ì„œ `ì „ì²´ ìƒí’ˆì„ ì¡°íšŒ`í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ìœ ì €ê°€ ì£¼ë¬¸ì„ ì›í•  ê²½ìš°, ì¹´íŠ¸ì— ì œí’ˆì„ ë‹´ìŠµë‹ˆë‹¤. ì¹´íŠ¸ë¥¼ ì£¼ë¬¸ì„œë¡œ ë³€í™˜í•˜ì—¬ ì£¼ë¬¸í•©ë‹ˆë‹¤.
- ìœ ì €ê°€ ì£¼ë¬¸ì„ ì™„ë£Œí•  ê²½ìš°, ì£¼ë¬¸ ìˆ˜ëŸ‰ë§Œí¼ ìƒí’ˆì˜ `ì¬ê³ ê°€ ê°ì†Œ`í•©ë‹ˆë‹¤.

# ğŸ”— ê¸°íƒ€

Elastic APM Java Agent ì„¤ì •

APM ì„¤ì • - ì¸í…”ë¦¬ì œì´ Edit Configurations -> VM Options ì— ì¶”ê°€ (Run ì‹œ ì‹¤í–‰ë¨)
```
-javaagent:/{jar íŒŒì¼ì˜ ìœ„ì¹˜}/elastic-apm-agent-1.34.1.jar
-Delastic.apm.disable_send=false
-Delastic.apm.environment=local
-Delastic.apm.service_name=freshcart
-Delastic.apm.enable_log_correlation=true
-Delastic.apm.application_packages=com.example.freshcart
-Delastic.apm.trace_methods_duration_threshold=1ms
-Delastic.apm.transaction_sample_rate=1
-Delastic.apm.server_urls=http://localhost:8200
-Delastic.apm.secret_token=
-Delastic.apm.span_frames_min_duration=1ms
-Delastic.apm.span_min_duration=0ms
-Delastic.apm.trace_methods=com.example.freshcart.*
-Delastic.apm.max_queue_size=2048

```
